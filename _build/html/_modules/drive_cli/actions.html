

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>drive_cli.actions &mdash; Resume_Parser  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Resume_Parser
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Resume_Parser</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Resume_Parser</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>drive_cli.actions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for drive_cli.actions</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">click</span>
<span class="kn">from</span> <span class="nn">pick</span> <span class="kn">import</span> <span class="n">Picker</span>
<span class="kn">from</span> <span class="nn">httplib2</span> <span class="kn">import</span> <span class="n">Http</span>
<span class="kn">from</span> <span class="nn">oauth2client</span> <span class="kn">import</span> <span class="n">file</span>
<span class="kn">from</span> <span class="nn">prettytable</span> <span class="kn">import</span> <span class="n">PrettyTable</span>
<span class="kn">from</span> <span class="nn">googleapiclient.discovery</span> <span class="kn">import</span> <span class="n">build</span>
<span class="kn">from</span> <span class="nn">prettytable</span> <span class="kn">import</span> <span class="n">MSWORD_FRIENDLY</span>
<span class="kn">from</span> <span class="nn">mimetypes</span> <span class="kn">import</span> <span class="n">MimeTypes</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../&#39;</span><span class="p">)</span>

<span class="n">dirpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dirpath</span><span class="p">)</span>
<span class="n">mime</span> <span class="o">=</span> <span class="n">MimeTypes</span><span class="p">()</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;view-files&#39;</span><span class="p">,</span> <span class="n">short_help</span><span class="o">=</span><span class="s1">&#39;filter search files and file ID for files user has access to&#39;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--name&#39;</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;provide username in whose repos are to be listed.&#39;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--types&#39;</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;provide username in whose repos are to be listed.&#39;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--pid&#39;</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;provide parent file ID or sharing link and list its child file/folders.&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">view_file</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">types</span><span class="p">,</span> <span class="n">pid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    view-files: Filter based list of the names and ids of the first 10 files the user has access to</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">flags</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;--name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">],</span> <span class="s2">&quot;--types&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">],</span> <span class="s2">&quot;--pid&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">]}</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="s1">&#39;token.json&#39;</span><span class="p">)</span>
    <span class="n">store</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">Storage</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    <span class="n">creds</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="s1">&#39;drive&#39;</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="n">http</span><span class="o">=</span><span class="n">creds</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">Http</span><span class="p">()))</span>
    <span class="n">page_token</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">q_name</span> <span class="o">=</span> <span class="n">click</span><span class="o">.</span><span class="n">prompt</span><span class="p">(</span><span class="s1">&#39;enter the search value&#39;</span><span class="p">)</span>
        <span class="n">flags</span><span class="p">[</span><span class="s2">&quot;--name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">q_name</span><span class="p">]</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;name contains &#39;&quot;</span> <span class="o">+</span> <span class="n">q_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; &quot;</span>
    <span class="k">if</span> <span class="n">types</span><span class="p">:</span>
        <span class="n">mimeTypes</span> <span class="o">=</span> <span class="p">{</span><span class="n">extension</span><span class="p">:</span> <span class="n">mime</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="s2">&quot;placeholder_filename.&quot;</span> <span class="o">+</span> <span class="n">extension</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">extension</span>
                     <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;xls&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;xlsx&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;xml&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;ods&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;csv&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;pdf&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;jpg&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;png&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;gif&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;bmp&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;txt&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;doc&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;js&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;swf&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;mp3&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;rar&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;tar&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;cab&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;html&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;htm&quot;</span><span class="p">)}</span>
        <span class="n">mimeTypes</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;tmpl&#39;</span><span class="p">:</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;php&#39;</span><span class="p">:</span> <span class="s1">&#39;application/x-httpd-php&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;arj&#39;</span><span class="p">:</span> <span class="s1">&#39;application/arj&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="s1">&#39;application/octet-stream&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;audio&quot;</span><span class="p">:</span> <span class="s1">&#39;application/vnd.google-apps.audio&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Google Docs&quot;</span><span class="p">:</span> <span class="s1">&#39;application/vnd.google-apps.document&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Google Drawing&quot;</span><span class="p">:</span> <span class="s1">&#39;application/vnd.google-apps.drawing&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Google Drive file&quot;</span><span class="p">:</span> <span class="s1">&#39;application/vnd.google-apps.file&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Google Forms&quot;</span><span class="p">:</span> <span class="s1">&#39;application/vnd.google-apps.form&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Google Fusion Tables&quot;</span><span class="p">:</span> <span class="s1">&#39;application/vnd.google-apps.fusiontable&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Google My Maps&quot;</span><span class="p">:</span> <span class="s1">&#39;application/vnd.google-apps.map&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Google Photos&quot;</span><span class="p">:</span> <span class="s1">&#39;application/vnd.google-apps.photo&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Google Slides&quot;</span><span class="p">:</span> <span class="s1">&#39;application/vnd.google-apps.presentation&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Google Apps Scripts&quot;</span><span class="p">:</span> <span class="s1">&#39;application/vnd.google-apps.script&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Google Sites&quot;</span><span class="p">:</span> <span class="s1">&#39;application/vnd.google-apps.site&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Google Sheets&quot;</span><span class="p">:</span> <span class="s1">&#39;application/vnd.google-apps.spreadsheet&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;3rd party shortcut&quot;</span><span class="p">:</span> <span class="s1">&#39;application/vnd.google-apps.drive-sdk&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;folder&quot;</span><span class="p">:</span> <span class="s1">&#39;application/vnd.google-apps.folder&#39;</span><span class="p">})</span>
        <span class="n">promptMessage</span> <span class="o">=</span> <span class="s1">&#39;Choose a media type to filter </span><span class="se">\n</span><span class="s1">(press SPACE to mark, ENTER to continue, s to stop):&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">promptMessage</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mimeTypes</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="n">picker</span> <span class="o">=</span> <span class="n">Picker</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">multi_select</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">min_selection_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">picker</span><span class="o">.</span><span class="n">register_custom_handler</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="n">utils</span><span class="o">.</span><span class="n">go_back</span><span class="p">)</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="n">picker</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">option</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot;and (&quot;</span>
            <span class="k">for</span> <span class="n">types</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">:</span>
                <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot;mimeType=&#39;&quot;</span> <span class="o">+</span> <span class="n">mimeTypes</span><span class="p">[</span><span class="n">types</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="s2">&quot;&#39; or &quot;</span>
                <span class="n">option</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">types</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">query</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
            <span class="n">flags</span><span class="p">[</span><span class="s2">&quot;--types&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">option</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">types</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">query</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
    <span class="k">if</span> <span class="n">pid</span><span class="p">:</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">click</span><span class="o">.</span><span class="n">prompt</span><span class="p">(</span><span class="s1">&#39;enter the fid of parent or  sharing link&#39;</span><span class="p">)</span>
        <span class="n">flags</span><span class="p">[</span><span class="s2">&quot;--pid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parent</span><span class="p">]</span>
        <span class="n">fid</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_fid</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">types</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; and &quot;</span>
        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">fid</span> <span class="o">+</span> <span class="s2">&quot;&#39; in parents&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">files</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
                                        <span class="n">spaces</span><span class="o">=</span><span class="s1">&#39;drive&#39;</span><span class="p">,</span>
                                        <span class="n">fields</span><span class="o">=</span><span class="s1">&#39;nextPageToken, files(id, name,mimeType,modifiedTime)&#39;</span><span class="p">,</span>
                                        <span class="n">pageToken</span><span class="o">=</span><span class="n">page_token</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>

        <span class="n">templist</span> <span class="o">=</span> <span class="p">[</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;files&#39;</span><span class="p">,</span> <span class="p">[])[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span> <span class="o">+</span> <span class="mi">25</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span>
            <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;files&#39;</span><span class="p">,</span> <span class="p">[])),</span> <span class="mi">25</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">templist</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">PrettyTable</span><span class="p">([</span><span class="s1">&#39;Sr.&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Modified Time&#39;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">fils</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">fils</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)[:</span><span class="mi">25</span><span class="p">],</span> <span class="n">fils</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span> <span class="n">fils</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s1">&#39;mimeType&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;application/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)[:</span><span class="mi">25</span><span class="p">],</span> <span class="n">fils</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;modifiedTime&#39;</span><span class="p">)])</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">click</span><span class="o">.</span><span class="n">confirm</span><span class="p">(</span><span class="s1">&#39;Do you want to continue?&#39;</span><span class="p">,</span> <span class="n">abort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">click</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">page_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nextPageToken&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">page_token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([</span><span class="n">flags</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;clone&#39;</span><span class="p">,</span> <span class="n">short_help</span><span class="o">=</span><span class="s1">&#39;download any file using sharing link or file ID it will be automatically tracked henceforth&#39;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">argument</span><span class="p">(</span><span class="s1">&#39;payload&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    clone: download a file/folder  using either the sharing link or using the file ID  for the file</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{},</span> <span class="n">payload</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">payload</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fid</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_fid</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;argument error&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">click</span><span class="o">.</span><span class="n">Context</span><span class="p">(</span><span class="n">download</span><span class="p">)</span> <span class="k">as</span> <span class="n">ctx</span><span class="p">:</span>
            <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="n">download</span><span class="o">.</span><span class="n">get_help</span><span class="p">(</span><span class="n">ctx</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">clone</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;cloning into &#39;&quot;</span> <span class="o">+</span> <span class="n">clone</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39; .....&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">clone</span><span class="p">[</span><span class="s1">&#39;mimeType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;application/vnd.google-apps.folder&#39;</span><span class="p">:</span>
        <span class="n">new_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="n">clone</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">create_new</span><span class="p">(</span><span class="n">new_dir</span><span class="p">,</span> <span class="n">fid</span><span class="p">)</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">pull_content</span><span class="p">(</span><span class="n">new_dir</span><span class="p">,</span> <span class="n">fid</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">file_download</span><span class="p">(</span><span class="n">clone</span><span class="p">,</span> <span class="n">cwd</span><span class="p">)</span>
    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;cloning of &quot;</span> <span class="o">+</span> <span class="n">clone</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; completed&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;add_remote&#39;</span><span class="p">,</span> <span class="n">short_help</span><span class="o">=</span><span class="s1">&#39;upload any existing file to drive&#39;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--file&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;specify the partcular file to uploaded else entire directory is uploaded&#39;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--pid&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;specify particular folder id/sharing_link of the folder under which remote must must be added&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_remote</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">pid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    add_remote: create remote equivalent for existing file/folder in local device</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{</span><span class="s2">&quot;--file&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">file</span><span class="p">],</span> <span class="s2">&quot;--pid&quot;</span><span class="p">:[</span><span class="n">pid</span><span class="p">]},</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">pid</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="s1">&#39;root&#39;</span>
    <span class="k">if</span> <span class="n">file</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
            <span class="n">utils</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;No such file exist: &quot;</span> <span class="o">+</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">click</span><span class="o">.</span><span class="n">Context</span><span class="p">(</span><span class="n">create_remote</span><span class="p">)</span> <span class="k">as</span> <span class="n">ctx</span><span class="p">:</span>
                <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="n">create_remote</span><span class="o">.</span><span class="n">get_help</span><span class="p">(</span><span class="n">ctx</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span>
        <span class="n">dir_cd</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cwd</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">cwd</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">child_cwd</span><span class="p">,</span> <span class="n">child_id</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">create_dir</span><span class="p">(</span><span class="n">dir_cd</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">push_content</span><span class="p">(</span><span class="n">child_cwd</span><span class="p">,</span> <span class="n">child_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pid</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">parent_file</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
        <span class="n">parent_name</span> <span class="o">=</span> <span class="n">parent_file</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;content added under directory &quot;</span> <span class="o">+</span>
                    <span class="n">parent_name</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;rm&#39;</span><span class="p">,</span> <span class="n">short_help</span><span class="o">=</span><span class="s1">&#39;delete a particular file in drive&#39;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--file&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;specify the partcular file to deleted else entire directory is deleted&#39;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--id&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;delete untracked file directly using id or sharing link, can be used even for unlinked files&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    rm: delete a particular file/folder from the directory in the remote drive</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{</span><span class="s2">&quot;--file&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">file</span><span class="p">],</span> <span class="s2">&quot;--id&quot;</span><span class="p">:[</span><span class="nb">id</span><span class="p">]},</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">id</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">file</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="n">local_dir</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_child</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
                <span class="n">fid</span> <span class="o">=</span> <span class="n">local_dir</span><span class="p">[</span><span class="n">file</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;No such file exist: &quot;</span> <span class="o">+</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">click</span><span class="o">.</span><span class="n">Context</span><span class="p">(</span><span class="n">delete</span><span class="p">)</span> <span class="k">as</span> <span class="n">ctx</span><span class="p">:</span>
                    <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="n">delete</span><span class="o">.</span><span class="n">get_help</span><span class="p">(</span><span class="n">ctx</span><span class="p">))</span>
            <span class="n">cwd</span> <span class="o">=</span> <span class="n">file_path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">drive_data</span><span class="p">()</span>
            <span class="n">fid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">cwd</span><span class="p">]</span>
            <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">utils</span><span class="o">.</span><span class="n">drive_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">delete_file</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fid</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_fid</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">delete_file</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;ls&#39;</span><span class="p">,</span> <span class="n">short_help</span><span class="o">=</span><span class="s1">&#39;list out all the files present in this directory in the drive for tracked directories&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">list_out</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ls: Print files belonging to a folder in the drive folder of the current directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{},</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">drive_data</span><span class="p">()</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="s1">&#39;token.json&#39;</span><span class="p">)</span>
    <span class="n">store</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">Storage</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    <span class="n">creds</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="s1">&#39;drive&#39;</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="n">http</span><span class="o">=</span><span class="n">creds</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">Http</span><span class="p">()))</span>
    <span class="n">page_token</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">cwd</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span>
            <span class="s2">&quot;following directory has not been tracked: </span><span class="se">\n</span><span class="s2">use drive add_remote or drive clone&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="n">cwd</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39; in parents&quot;</span>
    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s1">&#39;listing down files in drive ....&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">PrettyTable</span><span class="p">([</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;File ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Type&#39;</span><span class="p">])</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">children</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">files</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
                                        <span class="n">spaces</span><span class="o">=</span><span class="s1">&#39;drive&#39;</span><span class="p">,</span>
                                        <span class="n">fields</span><span class="o">=</span><span class="s1">&#39;nextPageToken, files(id,mimeType,name)&#39;</span><span class="p">,</span>
                                        <span class="n">pageToken</span><span class="o">=</span><span class="n">page_token</span>
                                        <span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;files&#39;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="n">child</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)[:</span><span class="mi">25</span><span class="p">],</span> <span class="n">child</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="s1">&#39;id&#39;</span><span class="p">),</span> <span class="n">child</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mimeType&#39;</span><span class="p">)])</span>
        <span class="n">page_token</span> <span class="o">=</span> <span class="n">children</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nextPageToken&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">page_token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">break</span>
        
    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<div class="viewcode-block" id="lists_out"><a class="viewcode-back" href="../../drive_cli.html#drive_cli.actions.lists_out">[docs]</a><span class="k">def</span> <span class="nf">lists_out</span><span class="p">(</span><span class="n">arguments_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ls: Print files belonging to a folder in the drive folder of the current directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">arguments_data</span><span class="p">[</span><span class="s2">&quot;Directory&quot;</span><span class="p">])</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{},</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">],</span><span class="n">arguments_data</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">drive_data</span><span class="p">(</span><span class="n">arguments_data</span><span class="p">)</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="s1">&#39;token.json&#39;</span><span class="p">)</span>
    <span class="n">store</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">Storage</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    <span class="n">creds</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="s1">&#39;drive&#39;</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="n">http</span><span class="o">=</span><span class="n">creds</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">Http</span><span class="p">()))</span>
    <span class="n">page_token</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">cwd</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span>
            <span class="s2">&quot;following directoryy has not been tracked: </span><span class="se">\n</span><span class="s2">use drive add_remote or drive clone&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="n">cwd</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39; in parents&quot;</span>
    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s1">&#39;listing down files in drive ....&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">PrettyTable</span><span class="p">([</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;File ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Type&#39;</span><span class="p">])</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">children</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">files</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
                                        <span class="n">spaces</span><span class="o">=</span><span class="s1">&#39;drive&#39;</span><span class="p">,</span>
                                        <span class="n">fields</span><span class="o">=</span><span class="s1">&#39;nextPageToken, files(id,mimeType,name)&#39;</span><span class="p">,</span>
                                        <span class="n">pageToken</span><span class="o">=</span><span class="n">page_token</span>
                                        <span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;files&#39;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="n">child</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)[:</span><span class="mi">2500</span><span class="p">],</span> <span class="n">child</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="s1">&#39;id&#39;</span><span class="p">),</span> <span class="n">child</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mimeType&#39;</span><span class="p">)])</span>
        <span class="n">page_token</span> <span class="o">=</span> <span class="n">children</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nextPageToken&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">page_token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">break</span>
    

    <span class="n">raw</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">strip</span><span class="p">,</span> <span class="n">splitline</span><span class="p">)))</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">raw</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">splitline</span> <span class="ow">in</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">splitline</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;../../pyresparser/&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">arguments_data</span><span class="p">[</span><span class="s2">&quot;drive_table&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span>

    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;../&#39;</span><span class="p">)</span>
    <span class="k">return</span> </div>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="n">short_help</span><span class="o">=</span><span class="s1">&#39;view contents of the file using its file id or sharing link&#39;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">argument</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="n">link</span><span class="p">):</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{},</span> <span class="n">link</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>
    <span class="n">fid</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_fid</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="n">short_help</span><span class="o">=</span><span class="s1">&#39;list changes committed since last sync&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">status</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    status: get a change log of files changed since you had the last sync(push/pull/clone)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{},</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">drive_data</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">cwd</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span>
            <span class="s2">&quot;following directory has not been tracked: </span><span class="se">\n</span><span class="s2">use drive add_remote or drive clone &quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sync_time</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">cwd</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">list_status</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="n">sync_time</span><span class="p">)</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;pull&#39;</span><span class="p">,</span> <span class="n">short_help</span><span class="o">=</span><span class="s1">&#39;get latest updates from online drive of the file&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pull</span><span class="p">():</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{},</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">drive_data</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">cwd</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span>
            <span class="s2">&quot;following directory has not been tracked: </span><span class="se">\n</span><span class="s2"> use drive add_remote or drive clone &quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">fid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">cwd</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
    <span class="n">current_root</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;checking for changes in &#39;&quot;</span> <span class="o">+</span>
                <span class="n">current_root</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39; ....&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">pull_content</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="n">fid</span><span class="p">)</span>
    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">current_root</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span>
                <span class="s2">&quot; is up to date with drive&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>




<div class="viewcode-block" id="pulls"><a class="viewcode-back" href="../../drive_cli.html#drive_cli.actions.pulls">[docs]</a><span class="k">def</span> <span class="nf">pulls</span><span class="p">(</span><span class="n">arguments_data</span><span class="p">):</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{},</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">],</span><span class="n">arguments_data</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">drive_data</span><span class="p">(</span><span class="n">arguments_data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cwd</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span>
            <span class="s2">&quot;following directory has not been tracked: </span><span class="se">\n</span><span class="s2">use drive add_remote or drive clone &quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">fid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">cwd</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;fid&quot;</span><span class="p">,</span><span class="n">fid</span><span class="p">)</span>
    <span class="n">current_root</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;checking for changes in &#39;&quot;</span> <span class="o">+</span>
                <span class="n">current_root</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39; ....&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">pull_content</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="n">fid</span><span class="p">,</span><span class="n">arguments_data</span><span class="p">)</span>
    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">current_root</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span>
                <span class="s2">&quot; is up to date with drive&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span></div>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;push&#39;</span><span class="p">,</span> <span class="n">short_help</span><span class="o">=</span><span class="s1">&#39;push modification from local files to the drive&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">push</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    push the latest changes from your local folder that has been added/cloned to google drive.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{},</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">drive_data</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">cwd</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span>
            <span class="s2">&quot;following directory has not been tracked: </span><span class="se">\n</span><span class="s2">use drive add_remote or drive clone &quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">fid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">cwd</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
    <span class="n">current_root</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;checking for changes in &#39;&quot;</span> <span class="o">+</span>
                <span class="n">current_root</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39; ....&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">push_content</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="n">fid</span><span class="p">)</span>
    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;Working directory is clean&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>


<span class="n">role_help</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;provide role to grant permission accordingly, following roles are currently allowed :</span>
<span class="s2">                * owner</span>
<span class="s2">                * writer</span>
<span class="s2">                * reader</span>
<span class="s2">                [Default]:reader</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">type_help</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;type of grantee, following are currently available :</span>
<span class="s2">                * user</span>
<span class="s2">                * group</span>
<span class="s2">                * anyone</span>
<span class="s2">                [Default]:user</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">message_help</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;provide a short message you want to send</span>
<span class="s2">                [Default]:&#39;shared via drive-cli&#39;</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;share&#39;</span><span class="p">,</span> <span class="n">short_help</span><span class="o">=</span><span class="s2">&quot;share file using file id or link&quot;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">argument</span><span class="p">(</span><span class="s1">&#39;fid&#39;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--role&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;reader&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">role_help</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--type&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">type_help</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--message&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;shared via drive-cli&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">message_help</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">share</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    share file/folder using using either the sharing link or using the file ID</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">flags</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;--role&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">role</span><span class="p">],</span> <span class="s2">&quot;--type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">type</span><span class="p">],</span> <span class="s2">&quot;--message&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">message</span><span class="p">]}</span>
    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;updating share setting.....&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
    <span class="n">file_id</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_fid</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="s1">&#39;token.json&#39;</span><span class="p">)</span>
    <span class="n">store</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">Storage</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    <span class="n">creds</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="s1">&#39;drive&#39;</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="n">http</span><span class="o">=</span><span class="n">creds</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">Http</span><span class="p">()))</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;anyone&quot;</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="n">role</span> <span class="o">==</span> <span class="s2">&quot;owner&quot;</span><span class="p">):</span>
            <span class="n">transfer_ownership</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">transfer_ownership</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">role</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span>
            <span class="s2">&quot;allowFileDiscovery&quot;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">permissions</span><span class="p">()</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="n">request</span><span class="p">,</span>
                                                    <span class="n">fileId</span><span class="o">=</span><span class="n">file_id</span><span class="p">,</span>
                                                    <span class="n">transferOwnership</span><span class="o">=</span><span class="n">transfer_ownership</span><span class="p">,</span>
                                                    <span class="n">fields</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">):</span>
                <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">][</span><span class="s2">&quot;message&quot;</span><span class="p">],</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">share_link</span> <span class="o">=</span> <span class="s2">&quot;https://drive.google.com/open?id=&quot;</span> <span class="o">+</span> <span class="n">file_id</span>
                <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;share link : &quot;</span> <span class="o">+</span> <span class="n">share_link</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">error_message</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">error_message</span> <span class="o">=</span> <span class="n">error_message</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">error_message</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;user&quot;</span><span class="p">):</span>
            <span class="n">email_id</span> <span class="o">=</span> <span class="n">click</span><span class="o">.</span><span class="n">prompt</span><span class="p">(</span><span class="s2">&quot;Enetr email address of user &quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">email_id</span> <span class="o">=</span> <span class="n">click</span><span class="o">.</span><span class="n">prompt</span><span class="p">(</span><span class="s2">&quot;Enetr email address of a google group &quot;</span><span class="p">)</span>
        <span class="n">flags</span><span class="p">[</span><span class="s2">&quot;Email ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">email_id</span>
        <span class="k">if</span><span class="p">(</span><span class="n">role</span> <span class="o">==</span> <span class="s2">&quot;owner&quot;</span><span class="p">):</span>
            <span class="n">transfer_ownership</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">transfer_ownership</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">role</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span>
            <span class="s2">&quot;emailAddress&quot;</span><span class="p">:</span> <span class="n">email_id</span>
        <span class="p">}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">permissions</span><span class="p">()</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="n">request</span><span class="p">,</span>
                                                    <span class="n">fileId</span><span class="o">=</span><span class="n">file_id</span><span class="p">,</span>
                                                    <span class="n">emailMessage</span><span class="o">=</span><span class="n">message</span><span class="p">,</span>
                                                    <span class="n">sendNotificationEmail</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                    <span class="n">transferOwnership</span><span class="o">=</span><span class="n">transfer_ownership</span><span class="p">,</span>
                                                    <span class="n">fields</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">):</span>
                <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">][</span><span class="s2">&quot;message&quot;</span><span class="p">],</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;successfully share&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">error_message</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">error_message</span> <span class="o">=</span> <span class="n">error_message</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">error_message</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([</span><span class="n">flags</span><span class="p">,</span> <span class="n">fid</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;history&#39;</span><span class="p">,</span> <span class="n">short_help</span><span class="o">=</span><span class="s2">&quot;view history&quot;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--date&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;specify the date to filter out your history&quot;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--clear&#39;</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;clear entire histroy&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">history</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">clear</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">clear</span><span class="p">:</span>
        <span class="n">click</span><span class="o">.</span><span class="n">confirm</span><span class="p">(</span><span class="s1">&#39;Do you want to continue?&#39;</span><span class="p">,</span> <span class="n">abort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;deleting.....&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">clear_history</span><span class="p">()</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;successfully deleted&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
        <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{</span><span class="s2">&quot;--date&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">date</span><span class="p">],</span> <span class="s2">&quot;--clear&quot;</span><span class="p">:[</span><span class="s2">&quot;True&quot;</span><span class="p">]},</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{</span><span class="s2">&quot;--date&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">date</span><span class="p">],</span> <span class="s2">&quot;--clear&quot;</span><span class="p">:[</span><span class="kc">None</span><span class="p">]},</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>
        <span class="n">History</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_history</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">date</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">History</span><span class="p">:</span>
                <span class="n">history</span> <span class="o">=</span> <span class="n">History</span><span class="p">[</span><span class="n">date</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">history</span><span class="p">:</span>
                    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">date</span> <span class="o">+</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;working directory : &quot;</span> <span class="o">+</span> <span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;cwd&quot;</span><span class="p">],</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;command : &quot;</span> <span class="o">+</span> <span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;command&quot;</span><span class="p">])</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;arg&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
                        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;argument : &quot;</span> <span class="o">+</span> <span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;arg&quot;</span><span class="p">])</span>
                    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;flags&quot;</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">flag_val</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;flags&quot;</span><span class="p">]:</span>
                            <span class="k">if</span><span class="p">(</span><span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;flags&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
                                <span class="n">val</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;flags&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                                <span class="n">flag_val</span> <span class="o">=</span> <span class="n">flag_val</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="n">val</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">flag_val</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
                            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;flags : &quot;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">flag_val</span><span class="p">)</span>
                    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;No histrory found!!!&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">History</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;No histrory found!!!&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">History</span><span class="p">:</span>
                    <span class="n">history</span> <span class="o">=</span> <span class="n">History</span><span class="p">[</span><span class="n">date</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">history</span><span class="p">:</span>
                        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">date</span> <span class="o">+</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;working directory : &quot;</span> <span class="o">+</span> <span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;cwd&quot;</span><span class="p">],</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;command : &quot;</span> <span class="o">+</span> <span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;command&quot;</span><span class="p">])</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;arg&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
                            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;argument : &quot;</span> <span class="o">+</span> <span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;arg&quot;</span><span class="p">])</span>
                        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;flags&quot;</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                            <span class="n">flag_val</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;flags&quot;</span><span class="p">]:</span>
                                <span class="k">if</span><span class="p">(</span><span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;flags&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
                                    <span class="n">val</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">history</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;flags&quot;</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                                    <span class="n">flag_val</span> <span class="o">=</span> <span class="n">flag_val</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="n">val</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="k">if</span><span class="p">(</span><span class="n">flag_val</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
                                <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;flags : &quot;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                                <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">flag_val</span><span class="p">)</span>
                        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">short_help</span><span class="o">=</span><span class="s2">&quot;It allows users to see who made edits and to revert to earlier versions of the same file.&quot;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">argument</span><span class="p">(</span><span class="s1">&#39;fid&#39;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--get&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;provide revision id to get more info &quot;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--delete&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;delete a particular revision&quot;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;--save&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;To keep revision forever, even if it is no longer the head revision. If not set, the revision will be automatically purged 30 days after newer content is uploaded. &quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_revision</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">get</span><span class="p">,</span> <span class="n">delete</span><span class="p">,</span> <span class="n">save</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    It allows users to see who made edits and to revert to earlier versions of the same file.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">flags</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;--get&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">get</span><span class="p">],</span> <span class="s2">&quot;--delete&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">delete</span><span class="p">],</span> <span class="s2">&quot;--save&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">save</span><span class="p">]}</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([</span><span class="n">flags</span><span class="p">,</span> <span class="n">fid</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="s1">&#39;token.json&#39;</span><span class="p">)</span>
    <span class="n">store</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">Storage</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    <span class="n">creds</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">if</span><span class="p">(</span><span class="n">get</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;fetching....&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
        <span class="n">service</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="s1">&#39;drive&#39;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="n">http</span><span class="o">=</span><span class="n">creds</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">Http</span><span class="p">()))</span>
        <span class="n">file_id</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_fid</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">revisions</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fileId</span><span class="o">=</span><span class="n">file_id</span><span class="p">,</span>
                                           <span class="n">revisionId</span><span class="o">=</span><span class="n">get</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
        <span class="n">modified_time</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;modifiedDate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;lastModifyingUser&quot;</span><span class="p">]</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">click</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="s2">&quot;File : &quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span>
                    <span class="n">response</span><span class="p">[</span><span class="s2">&quot;originalFilename&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;mimeType&quot;</span><span class="p">])</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">click</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="s2">&quot;Link : &quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
                                <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;selfLink&quot;</span><span class="p">])</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">click</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="s2">&quot;Author : &quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span>
                    <span class="n">response</span><span class="p">[</span><span class="s2">&quot;lastModifyingUserName&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">user</span><span class="p">[</span><span class="s2">&quot;emailAddress&quot;</span><span class="p">])</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">click</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="s2">&quot;Date : &quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span>
                    <span class="n">modified_time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">modified_time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">click</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="s2">&quot;File size : &quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
                                <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;fileSize&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;bytes&quot;</span><span class="p">)</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">click</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="s2">&quot;eTag : &quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
                                <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;etag&quot;</span><span class="p">])</span>
        <span class="k">if</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;published&quot;</span><span class="p">]):</span>
            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">click</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="s2">&quot;Published : &quot;</span><span class="p">,</span>
                                    <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;Yes&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">click</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="s2">&quot;Published : &quot;</span><span class="p">,</span>
                                    <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;No&quot;</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;pinned&quot;</span><span class="p">]):</span>
            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">click</span><span class="o">.</span><span class="n">style</span><span class="p">(</span>
                <span class="s2">&quot;Pinned : &quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;Yes&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">click</span><span class="o">.</span><span class="n">style</span><span class="p">(</span>
                <span class="s2">&quot;Pinned : &quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;No&quot;</span><span class="p">)</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">click</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="s2">&quot;Permission Id : &quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span>
                    <span class="n">user</span><span class="p">[</span><span class="s2">&quot;permissionId&quot;</span><span class="p">])</span>

    <span class="k">if</span><span class="p">(</span><span class="n">delete</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;deleting.....&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
        <span class="n">service</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="s1">&#39;drive&#39;</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="n">http</span><span class="o">=</span><span class="n">creds</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">Http</span><span class="p">()))</span>
        <span class="n">file_id</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_fid</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">revisions</span><span class="p">()</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">fileId</span><span class="o">=</span><span class="n">file_id</span><span class="p">,</span>
                                              <span class="n">revisionId</span><span class="o">=</span><span class="n">delete</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;revision&quot;</span> <span class="o">+</span> <span class="n">delete</span> <span class="o">+</span> <span class="s2">&quot;successfully deleted&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">save</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;saving &quot;</span> <span class="o">+</span> <span class="n">save</span> <span class="o">+</span>
                    <span class="s2">&quot; revision premanently....&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
        <span class="n">service</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="s1">&#39;drive&#39;</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="n">http</span><span class="o">=</span><span class="n">creds</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">Http</span><span class="p">()))</span>
        <span class="n">file_id</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_fid</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">revisions</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;keepForever&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                                              <span class="n">fileId</span><span class="o">=</span><span class="n">file_id</span><span class="p">,</span>
                                              <span class="n">revisionId</span><span class="o">=</span><span class="n">save</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;svaed successfully&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">delete</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">get</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">save</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">file_id</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_fid</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">fid</span><span class="p">)[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;fetching revision detail of &quot;</span> <span class="o">+</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;.....&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
        <span class="n">service</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="s1">&#39;drive&#39;</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="n">http</span><span class="o">=</span><span class="n">creds</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">Http</span><span class="p">()))</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">revisions</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">fileId</span><span class="o">=</span><span class="n">file_id</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
        <span class="n">revisions</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;revisions&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">revisions</span><span class="p">):</span>
            <span class="n">modified_time</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;modifiedTime&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;Date : &quot;</span> <span class="o">+</span> <span class="n">modified_time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">modified_time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;File : &quot;</span> <span class="o">+</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;file-info&#39;</span><span class="p">,</span> <span class="n">short_help</span><span class="o">=</span><span class="s2">&quot;get information about file/folder&quot;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">argument</span><span class="p">(</span><span class="s1">&#39;fid&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">file_info</span><span class="p">(</span><span class="n">fid</span><span class="p">):</span>
    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;fetching....&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{},</span> <span class="n">fid</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="s1">&#39;token.json&#39;</span><span class="p">)</span>
    <span class="n">store</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">Storage</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    <span class="n">creds</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="s1">&#39;drive&#39;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="n">http</span><span class="o">=</span><span class="n">creds</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">Http</span><span class="p">()))</span>
    <span class="n">file_id</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_fid</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">PrettyTable</span><span class="p">([</span><span class="s2">&quot;Genreal Info&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">])</span>
    <span class="n">t</span><span class="o">.</span><span class="n">align</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">files</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fileId</span><span class="o">=</span><span class="n">file_id</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
    <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]])</span>
    <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]])</span>
    <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Mime Type&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="s2">&quot;mimeType&quot;</span><span class="p">]])</span>
    <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Self Link&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="s2">&quot;selfLink&quot;</span><span class="p">]])</span>
    <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;e-tag&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="s2">&quot;etag&quot;</span><span class="p">]])</span>
    <span class="n">date_time</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s2">&quot;createdDate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">date_time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">date_time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;created date&quot;</span><span class="p">,</span> <span class="n">date</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">time</span><span class="p">])</span>
    <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;can edit&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s2">&quot;capabilities&quot;</span><span class="p">][</span><span class="s2">&quot;canEdit&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">])</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">parents</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">parents</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">fileId</span><span class="o">=</span><span class="n">file_id</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parents</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;Parent Info&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">]:</span>
                <span class="n">parent_name</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">parent</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">parent_name</span><span class="p">])</span>
                <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]])</span>
                <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Link&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="p">[</span><span class="s2">&quot;parentLink&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">])</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">permissions</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">permissions</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">fileId</span><span class="o">=</span><span class="n">file_id</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
        <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;Permissions&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">])</span>
        <span class="n">per_num</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">permission</span> <span class="ow">in</span> <span class="n">permissions</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">]:</span>
            <span class="n">per_num</span> <span class="o">=</span> <span class="n">per_num</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">permission</span><span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="n">per_num</span><span class="p">,</span> <span class="s2">&quot;User name&quot;</span><span class="p">,</span> <span class="n">permission</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]])</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;email address&quot;</span><span class="p">,</span> <span class="n">permission</span><span class="p">[</span><span class="s2">&quot;emailAddress&quot;</span><span class="p">]])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;domain name&quot;</span><span class="p">,</span> <span class="n">permission</span><span class="p">[</span><span class="s2">&quot;domain&quot;</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="n">per_num</span><span class="p">,</span> <span class="n">permission</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="s2">&quot;&quot;</span><span class="p">])</span>
            <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;role&quot;</span><span class="p">,</span> <span class="n">permission</span><span class="p">[</span><span class="s2">&quot;role&quot;</span><span class="p">]])</span>
            <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="n">permission</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">])</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">revisions</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">revisions</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">fileId</span><span class="o">=</span><span class="n">file_id</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
        <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;Revision&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">])</span>
        <span class="n">rev_num</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">rev</span> <span class="ow">in</span> <span class="n">revisions</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">]:</span>
            <span class="n">rev_num</span> <span class="o">=</span> <span class="n">rev_num</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="n">rev_num</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="n">rev</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]])</span>
            <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;modified by&quot;</span><span class="p">,</span> <span class="n">rev</span><span class="p">[</span><span class="s2">&quot;lastModifyingUser&quot;</span><span class="p">][</span><span class="s2">&quot;displayName&quot;</span><span class="p">]])</span>
            <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;email address&quot;</span><span class="p">,</span> <span class="n">rev</span><span class="p">[</span><span class="s2">&quot;lastModifyingUser&quot;</span><span class="p">][</span><span class="s2">&quot;emailAddress&quot;</span><span class="p">]])</span>
            <span class="n">date_time</span> <span class="o">=</span> <span class="n">rev</span><span class="p">[</span><span class="s2">&quot;modifiedDate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">date_time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">date_time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;modified date&quot;</span><span class="p">,</span> <span class="n">date</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">time</span><span class="p">])</span>
            <span class="n">t</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;file size&quot;</span><span class="p">,</span> <span class="n">rev</span><span class="p">[</span><span class="s2">&quot;fileSize&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">])</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="n">t</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">MSWORD_FRIENDLY</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">short_help</span><span class="o">=</span><span class="s2">&quot;never track the listed local file and folders of current working directory&quot;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">argument</span><span class="p">(</span><span class="s1">&#39;unttrack_file&#39;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;-l&#39;</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;list out all the untracked files&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">drive_ignore</span><span class="p">(</span><span class="n">unttrack_file</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">drive_ignore_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="s1">&#39;.driveignore&#39;</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unttrack_file</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">drive_ignore_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">files</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">drive_ignore_path</span><span class="p">,</span> <span class="s1">&#39;a+&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">unttrack_file</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">f</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="n">f</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">):</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">f</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; doesn&#39;t exist in &quot;</span> <span class="o">+</span> <span class="n">cwd</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">l</span><span class="p">:</span>
        <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;listing untracked files....&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;magenta&quot;</span><span class="p">)</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{</span><span class="s2">&quot;-l&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;True&quot;</span><span class="p">]},</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">drive_ignore_path</span><span class="p">):</span>
            <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">drive_ignore_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">untracked_files</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="n">untracked_files</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="s2">&quot;.driveignore file doesn&#39;t exist in &quot;</span> <span class="o">+</span> <span class="n">cwd</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">save_history</span><span class="p">([{</span><span class="s2">&quot;-l&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">]},</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">])</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Rahul Bansal

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>